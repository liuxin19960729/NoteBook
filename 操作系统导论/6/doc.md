## 受限直接使用
```
操作系统必须以高性能的方式虚拟化CPU,同时保持对刺痛的控制
```
## 受限直接执行
```
两个问题:
 1.操作系统如何限制进程去做一些事情
 2.操作系统如何使进程停止并且切换另一个进程执行
```
## 操作系统如何限制进程去做一些事情
```
硬件提供不同的执行模式协助操作系统
1. user mode
  程序完全不能访问硬件
2.kernel mode
  可以访问机器的全部资源



硬件提供
  陷入(trap)内核 和 从陷阱 返回的用户模式



x86 
  调用特殊的trap 指令跳转到内核将模式提升成
  kernel ,先将用户寄存器等状态数据保存到内核栈
  内核做完任务将内核栈的转态数据放到对应的寄存器,在
  返回 并且将内核模式切换成用户模式



内核在启动的时候会设置陷阱表
    os 告诉 发生那些异常的时候,具体执行的代码在哪里 
```
## 进程之间的切换
### 非协作方式进行操作系统控制
```
时钟中断
每隔几毫秒产生一次中断,当前执行的用户程序停止,进入
到OS预先设置的时钟中断处理程序
OS此时重新获得执行权限
```
### 保存和恢复上下文
```
上下文切换：
  为当前正在执行的进程保存一些寄存器值到内核栈
  并未即将执行的进程恢复寄存器值从内核栈
```
### 担心并发吗
```
当OS 处理终端期间 发生其他的中断 ,OS 并发(第二部分会解决)


```